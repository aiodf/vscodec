#### 如何更新BMS

通过can线连接bms调试口，设置成速率250k，点击系统更新，将BMS断电，重新打上，在长按power按键，点击更新。等待更新完成，点击配置信息，确认有没有更新成功

## 图形编辑器

##### 运动条

显示的时候正反向的问题

![image-20241111102037423](D:\TYPORA_图片\image-20241111102037423.png)

活动数据连接表示是否启用运动条，如果反向数据连接的取值为0，则表示正向运动，取值为1，则为反向运动

![image-20241111102109373](D:\TYPORA_图片\image-20241111102109373.png)

![image-20241111102125807](D:\TYPORA_图片\image-20241111102125807.png)

#### 交流电路部分参数

##### 有功功率（P）、无功功率(Q)和视在功率(S)

在交流电路中，有功功率、无功功率和视在功率是三个重要的参数（要素）。有功功率是负载消耗的功率，表示实际提供给设备或装置用来执行工作的电功率。无功功率是不被负载消耗的功率，是通过电网传输电力时产生的必要能量。视在功率是表示总功率的指标。视在功率可视为是有功功率和无功功率的总和，可管理电流和电压的相位差，确保在电网内的稳定运行。



## 恩玖PCS



关于网口版的恩玖PCS通讯

![image-20241101184317056](D:\TYPORA_图片\image-20241101184317056.png)



![image-20241101184747722](D:\TYPORA_图片\image-20241101184747722.png)



恩玖PCS端子

![image-20241102083236197](D:\TYPORA_图片\image-20241102083236197.png)

 ![](D:\TYPORA_图片\image-20241102083537640.png)





BMS是诺万的，BMS内部有BMU，可以通过王工的CAN盒的串口端子接入首尾电池串口，得出电池组的数据。



#### 刷新程序后需要修改的事情

控制板EEPROM故障

后台通信协议故障

上面的EEPROM不用管，下面的后台通讯协议故障需要通过屏蔽字去解决![image-20241105154033990](D:\TYPORA_图片\image-20241105154033990.png)



需要将母线电压定标系数修改成7258

电池电压定标系数修改成22796

![image-20241105154246037](D:\TYPORA_图片\image-20241105154246037.png)



然后固化参数bits8，需要勾选两次，估计是用于重复确认固定成功



关于BMS地址设置，因为是使用派能协议，派能发送的报文数据是0x4230，0x4240~0x42e0，末尾数据是0，所以改为0，如果是0x4211则改为1

![c199df41d25732daf2deae0a659ba65](D:\TYPORA_图片\c199df41d25732daf2deae0a659ba65.jpg)

再通过2.17的PC控制命令bits15 reset，重新启动

![a47943c92bb97e1d33fa0034ed621b9](D:\TYPORA_图片\a47943c92bb97e1d33fa0034ed621b9-1730792761779-5.jpg)

再次之前有一个JSON文件，具体左右未知。下面的dat文件是用于PCS更新

![7efb18505ebb2df7b4eea403856e311](D:\TYPORA_图片\7efb18505ebb2df7b4eea403856e311.jpg)



空气开关左边是空调开关，右边是排插开关

![6db40739607293315b0d87e3ab696e4](D:\TYPORA_图片\6db40739607293315b0d87e3ab696e4.jpg)

空调与EMS通过485通讯，为A1 B1

![c00c727d87a37cabe6ac85ca276b3e1](D:\TYPORA_图片\c00c727d87a37cabe6ac85ca276b3e1.jpg)





## linux

tar -zcvf scada_root.tar.gz scada_root  压缩scada_root文件夹，打包成scada_root.tar.gz

tar -zxvf scada_root.tar.gz      解压scada_root.tar.gz到当前文件夹



##### 关闭scada系统

sudo systemctl stop scada



## 光储项目

云天数能的光储控制柜，包括MPPT，EMS,PCS,STS

#### 部分参数说明

##### 一、MPPT作用

MPPT的作用是什么？由于太阳能电池收到光强以及环境等外界因素的影响，其输出功率是变化的，光强发出的电就多，带MPPT最大功率跟踪的光伏逆变器就是为了充分的利用太阳能电池，使之运行在最大功率点。也就是说在太阳辐射不变的情况下，有MPPT后的输出功率会比没有MPPT前的要高，这就是MPPT的作用所在。就假设说MPPT还没开始跟踪，这时组件输出电压是500V，然后MPPT开始跟踪之后，就开始通过内部的电路结构调节回路上的电阻，以改变组件输出电压，同时改变输出电流，一直到输出功率最大(假设是550V最大)，此后就不断得跟踪，这样一来也就是说在太阳辐射不变的情况下，组件在550V的输出电压情况，输出功率会比500V时要高，这就是MPPT的作用。

最大功率点跟踪的原理随着电子技术的发展，当前太阳能电池阵列的MPPT控制一般是通过DC/DC变换电路来完成的。其原理框图如下图所示。光伏电池阵列与负载通过DC/DC电路连接，最大功率跟踪装置不断检测光伏阵列的电流电压变化，并根据其变化对DC/DC变换器的PWM驱动信号占空比进行调节。



##### 二、STS作用、ATS作用

STS双电源静态转换开关(StaticTransferSwitch)产品可为单电源设备提供高可靠的冗余电源。机架结构的STS配备双重输入电源线向连接的设备供电，当主电源出现异常，备用电源将即可无逢对STS 供电，而不会中断关键负载的电力供应。联网设备具有内置的网络连接功能，可通过Web、SNMP或TeInet接口实现远程管理。

STS为二选一自动切换系统，当第一路电源出现故障后STS自动切换到第二路负载供电（**前提是第二路电源正常且和第一路基本同步**），第二路故障的化STS自动切换到第一路负载供电，适合用于UPS与UPS、UPS与发电机、UPS与市电、市电与市电等任意两路电源的不间断切换，以上所有电源间都需要同步装置，保证两路电源基本同步，否则STS无法切换。

STS静态电源切换开关主要由智能控制板，**高速可控硅**，断路器构成。其标准**切换时间为5ms-10ms**，**不会造成IT类负载断电**。既对负载可靠供电，同时又能保证STS在不同相切换时的安全性。STS的基本应用包括电力工业的自动化系统，石化工业的电源系统，计算机和远程通讯中心，大楼的自动化和安全系统，以及其他对电源中断敏感的设备。





ATS也称ATSE（Automatic Transfer Switch），是一种电磁式双电源自动转换开关，其主要工作原理是通过电磁锁来实现电源的自动切换。ATS主要用在紧急供电系统，当主电源发生故障时，ATS会自动断开主电源，并迅速连接到备用电源，以确保重要负载能够连续、可靠运行。ATS为机械结构，转换时间为**100ms**以上，转换时会造成负载断电、适合照明、电机负载。目前市面上的ATS基本是使用UPS辅助配合达到不间断双电源的切换。ATS通常具有手动和自动两种操作模式，可在紧急情况下进行手动切换。

##### 应用场景：

ATS和STS在应用场景上有一定的区别。ATS适用于需要连续供电的场合，如重要工业生产、数据中心、医院等。

而STS则适用于对电源质量要求较高的场合，如通信基站、精密仪器、实验室等。

##### 可靠性：

ATS的可靠性更高一些。因为ATS采用机械触点切换，具有较强的抗干扰能力和较高的切换成功率。而STS采用电子开关切换，可能会受到电磁干扰、温度等因素的影响，导致可靠性略有降低。





box，表示的是汇流箱

太阳能浪涌保护 (SPD) 旨在限制瞬态过电压并将电流波转移到大地。 此外，它将过电压的幅度限制在对电气基础设施和开关设备安全的值。

![a201b12943e1e4f15f2dab25b22ffe5](D:\TYPORA_图片\a201b12943e1e4f15f2dab25b22ffe5.png)



充电电压上限：224*3.65 = 817

放电电压下限：224*2.75 = 616

DOD：深度放电，大概是总功率乘上数值

强充开启：表示单体电压到达2650mv即开始充电

DCAC单体保护电压：表示单体电压到达3650mv即停止充电

![d9bfa506c09bb785a07fc6032bc6e76](D:\TYPORA_图片\d9bfa506c09bb785a07fc6032bc6e76.jpg)

## Qt

信号与槽机制要求信号和槽的参数一致，所谓一致，是参数类型一致。如果不一致，允许的情况是，信号的参数可以比槽函数的参数多，此时槽可以忽略多余参数。

### 部分标签说明

红色标签表示，这是一个函数

带锁的标签表示，这是一个保护/私有

![image-20241112085126944](D:\TYPORA_图片\image-20241112085126944.png)

表示这是一个enum，枚举类型

![image-20241112085252462](D:\TYPORA_图片\image-20241112085252462.png)

表示这是一个类

![image-20241112085650625](D:\TYPORA_图片\image-20241112085650625.png)

表示这是一个槽

![image-20241112085725324](D:\TYPORA_图片\image-20241112085725324.png)

表示信号函数

![image-20241112090504875](D:\TYPORA_图片\image-20241112090504875.png)

表示宏定义

![image-20241112090605095](D:\TYPORA_图片\image-20241112090605095.png)

### 头文件用途

QFile : 用于查找、添加文件功能



##### （1） Comb Box:组合框

QComboBox 继承 QWidget 类，被 QFontComboBox 类继承。通常用于用户显示选项列表的
方法，这种方法占用最少的屏幕空间。

##### （2） Font Comb Box:字体组合框

QFontComboBox 继承 QComboBox。QFontComboBox 小部件是一个允许用户选择字体系列
的组合框。组合框中填充了按字母顺序排列的字体家族名称列表。FontComboBox 常用于工具
栏，与 ComboBox 一起用于控制字体大小，并与两个 ToolButtons 一起用于粗体和斜体。

##### （3） Line Edit:单行编辑框

QLineEdit 继承 QWidget。QLineEdit 小部件是一个单行文本编辑器。行编辑允许用户使用
一组有用的编辑函数输入和编辑一行纯文本，包括撤消和重做、剪切和粘贴以及拖放。通过更
改行编辑的 echoMode()，它还可以用作“只写”字段，用于输入如密码等。

##### （4） Text Edit:文本编辑框

QTextEdit 继承 QAbstractScrollArea，被 QTextBrowser 继承。QTextEdit 是一个高级所见即
所得查看器/编辑器，支持使用 html 样式的标记进行 rich text 格式化。它经过优化以处理大型
文档并快速响应用户输入。QTextEdit 用于段落和字符。段落是格式化的字符串，它被字包装以
适应小部件的宽度。在阅读纯文本时，默认情况下，一个换行表示一个段落。一份文件由零个
或多个段落组成。段落中的文字与段落的对齐方式一致。段落之间用硬换行符隔开。段落中的
每个字符都有自己的属性，例如字体和颜色。QTextEdit 可以显示图像，列表和表格。如果文本
太大而无法在文本编辑的视图中查看，视图中则会出现滚动条。

##### （5） Plain Text Edit:纯文本编辑框

QPlainTextEdit 是一个支持纯文本的高级查看器/编辑器。它被优化为处理大型文档和快速
响应用户输入。

##### （6） Spin Box:数字旋转框

QSpinBox 继承 QAbstractSpinBox。用于处理整数和离散值（例如：月份名称）而 QDoubl
eSpinBox 则用于处理浮点值。他们之间的区别就是处理数据的类型不同，其他功能都基本相同。
QSpinBox 允许用户通过单击上/下按钮或按下键盘上的上/下按钮来选择一个值，以增加/减少当
前显示的值。用户还可以手动输入值。

##### （7） Double Spin Box:双精度数字旋转框

QDoubleSpinBox 继承 QAbstractSpinBox。QDoubleSpinBox 则用于处理浮点值。QDoubleS
pinBox 允许用户通过单击“向上”和“向下”按钮或按下键盘上的“向上”或“向下”按钮来
选择当前显示的值。用户还可以手动输入值。

##### （8） Time Edit:时间编辑框

QTimeEdit 继承 QDateTimeEdit。QTimeEdit 用于编辑时间，而 QDateEdit 用于编辑日期。

##### （9） Date Edit:日期编辑框

QDateEdit 继承 QDateTimeEdit。QDateEdit 用于编辑日期，而 QTimeEdit 用于编辑时间。

##### （10） Date/Time Edit:日期时间编辑框

QDateTimeEdit 类提供了一个用于编辑日期和时间的小部件。QDateTimeEdit 允许用户使用
键盘或箭头键编辑日期，以增加或减少日期和时间值。箭头键可用于在 QDateTimeEdit 框中从
一个区域移动到另一个区域。

##### （11） Dial:数字拨盘框

QDial 类提供了一个圆形范围控制(如速度计或电位器)。QDial 用于当用户需要在可编程定
义的范围内控制一个值，并且该范围要么是环绕的(例如，从 0 到 359 度测量的角度)，要么对
话框布局需要一个正方形小部件。由于 QDial 从 QAbstractSlider 继承，因此拨号的行为与滑块
类似。 当 wrapping（）为 false（默认设置）时，滑块和刻度盘之间没有真正的区别。 它们共
享相同的信号，插槽和成员功能。 您使用哪一个取决于您的用户期望和应用程序类型。

##### （12） Horizontal Scroll Bar:水平滚动条

QScrollBar 继承 QAbstractSlider。QScrollBar 小部件提供垂直或水平滚动条，允许用户访问
比用于显示文档的小部件大的文档部分。它提供了用户在文档中的当前位置和可见文档数量的
可视化指示。滚动条通常配有其他控件，可以实现更精确的导航。

##### （13） Vertical Scroll Bar:垂直滚动条

QSlider 继承 QAbstractSlider。QSlider 类提供垂直或水平滑动条小部件，滑动条是用于控制
有界值的典型小部件。它允许用户沿着水平或垂直凹槽移动滑块手柄，并将手柄的位置转换为
合法范围内的整数值。

##### （14） Horizontal Slider:水平滑动条
##### （15） Vertical Slider:垂直滑动条
##### （16） Key sequence Edit:按键序列编辑框

QKeySequenceEdit 继承 QWidget。这个小部件允许用户选择 QKeySequence, QKeySequence
通常用作快捷方式。当小部件接收到焦点并在用户释放最后一个键后一秒结束时，将启动记录，
通常用作记录快捷键。

### QSS

QCheckBox:表示复选按钮

![image-20241112111456892](D:\TYPORA_图片\image-20241112111456892.png)
